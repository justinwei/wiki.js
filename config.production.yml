#######################################################################
# Wiki.js - 生产环境配置示例                                            #
#######################################################################
# 完整文档: https://docs.requarks.io/install

# ---------------------------------------------------------------------
# 服务端口
# ---------------------------------------------------------------------

port: 3000

# ---------------------------------------------------------------------
# 数据库配置
# ---------------------------------------------------------------------
# 支持的数据库:
# - postgres = PostgreSQL 9.5 或更高版本
# - mysql = MySQL 8.0 或更高版本
# - mariadb = MariaDB 10.2.7 或更高版本
# - mssql = MS SQL Server 2012 或更高版本
# - sqlite = SQLite 3.9 或更高版本

db:
  type: postgres

  # PostgreSQL / MySQL / MariaDB / MS SQL Server:
  host: db                    # Docker 环境中使用服务名
  port: 5432
  user: wikijs
  pass: wikijsrocks          # ⚠️ 请修改为强密码
  db: wiki
  ssl: false

  # SSL 选项 (可选 - 仅 PostgreSQL / MySQL / MariaDB):
  sslOptions:
    auto: true

  # PostgreSQL schema (可选):
  schema: public

  # SQLite 配置:
  # storage: /wiki/data/database.sqlite

# ---------------------------------------------------------------------
# SSL/TLS 设置
# ---------------------------------------------------------------------
# 如果使用 Nginx 反向代理,建议在 Nginx 层配置 SSL
# 如果直接暴露 Wiki.js,可以在这里配置证书

ssl:
  enabled: false
  port: 3443
  provider: letsencrypt       # custom, letsencrypt

  # Custom 证书配置:
  format: pem                  # pem, pfx
  key: path/to/key.pem
  cert: path/to/cert.pem
  passphrase: null
  dhparam: null

  # Let's Encrypt 配置:
  domain: wiki.yourdomain.com
  subscriberEmail: admin@yourdomain.com

# ---------------------------------------------------------------------
# 日志设置
# ---------------------------------------------------------------------

logLevel: info               # error, warn, info, verbose, debug, silly

# ---------------------------------------------------------------------
# 上传文件限制
# ---------------------------------------------------------------------

uploads:
  maxFileSize: 10485760      # 10 MB (单位: 字节)
  maxFiles: 10               # 单次上传最大文件数

# ---------------------------------------------------------------------
# 离线模式
# ---------------------------------------------------------------------
# 禁用所有外部网络请求

offline: false

# ---------------------------------------------------------------------
# 高可用 (HA)
# ---------------------------------------------------------------------
# 多实例部署时需要配置

ha: false

# ---------------------------------------------------------------------
# 数据路径
# ---------------------------------------------------------------------

dataPath: /wiki/data         # Docker 环境中的数据目录

# ---------------------------------------------------------------------
# 会话设置
# ---------------------------------------------------------------------

sessionSecret: $(openssl rand -base64 32)  # 请生成随机字符串

# ---------------------------------------------------------------------
# 邮件服务器配置
# ---------------------------------------------------------------------

mail:
  host: smtp.example.com
  port: 465
  secure: true
  user: noreply@yourdomain.com
  pass: your_email_password
  name: Wiki.js
  from: noreply@yourdomain.com

# ---------------------------------------------------------------------
# 身份认证
# ---------------------------------------------------------------------

auth:
  audience: urn:wiki.js
  tokenExpiration: 30m
  tokenRenewal: 14d

# ---------------------------------------------------------------------
# 功能特性
# ---------------------------------------------------------------------

features:
  featurePageRatings: true
  featurePageComments: true
  featurePersonalWikis: true

# ---------------------------------------------------------------------
# 安全设置
# ---------------------------------------------------------------------

security:
  securityOpenRedirect: true
  securityIframe: false
  securityReferrerPolicy: same-origin
  securityTrustProxy: false
  securitySRI: true
  securityHSTS: false
  securityHSTSDuration: 300
  securityCSP: false
  securityCSPDirectives: ''
