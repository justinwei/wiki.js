# 一、参数以及api描述
### API 介绍
#### record.createPlayer(option)
创建录音的函数，并始终返回一个 curr_record 对象，参数option是一个obj，具体含义如下：
```
var option = {
	type: "amr",//pcm、spx、amr
	path: "./fatfs/12.amr", //有路径表示存文件
	data_type:"buffer",	//类型支持buffer、pointer，不填-默认buffer
    pcm: {
        rate:8000,	//pcm 采样率
		channels:1,	//pcm 通道数
		format:16,	//pcm 格式位宽（8、16、24、32）
        period_size: 160,  //表示有多少帧
        period_count: 1,   //表示有多少个period_size
    },
	param: {	//对应type的参数，具体如下
		/*spx config*/
		//mode:1,		//spx 模式（0-nb、1-wb）
		//quality:7,	//spx 质量
		//frame_size:320,	//spx 帧大小
		/*amr config*/
		mode:0,		//amr 模式（0-nb、1-wb）
		rate:1,		//amr 编码方式，使用默认
	}
};
```

#### curr_record 事件
当创建成功后，返回的 curr_record 对象可通过 on 方法监听多个事件，业务逻辑可在监听的回调函数中完成。以下列举一些常用的事件：

* start
##### 录音开始是触发，参数韦options，内容为创建编码内容
```
curr_record.on('start', function(opt) {
	console.debug('start', opt);
})
```

* data
##### 录音有数据时触发，参数为 options, options可以是一个指针或者buffer， 默认buffer， （PS: 大于500ms回调一次）
```
curr_record.on('data', function(option) {
	console.debug('option', typeof(option), option);
})
```

* end
##### 录音结束触发，调用curr_record.stop()方法后异步回调或者超时后触发
```
curr_record.on('end', function() {
	console.debug('end');
})
```
* error
##### 录音过程出现异常是触发， 参数为 err，具体含义后续补充
```
curr_record.on('error', function(err) {
	console.debug('error', err);
})
```

#### curr_record方法
curr_record除监听事件外，也内置一些方法，用来进行控制录音，以下列举一些常用的方法。

* ```curr_record.start()```
开始录音的函数。

* ```curr_record.stop()```
结束录音的函数。

### 例子
```
var record = require('record');

var option = {
	type: "amr",
	path: "./fatfs/12.amr",
	data_type:"buffer",
    pcm: {
        rate:8000,
		channels:1,
		format:16,
        period_size: 160,
        period_count: 1,
    },
	param: {
		mode:0,
		rate:1,
	}
};

var curr_record = record.createRecord(option);


curr_record.on('data', function(option, frame_num) {
	console.debug('option', typeof(option), option);
	console.debug('option len', option.length, 'frame_num', frame_num);
})

curr_record.on('start', function(opt) {
	console.debug('start', opt);
})

curr_record.on('error', function(err) {
	console.debug('error', err);
})

curr_record.on('end', function() {
	console.debug('end');
})

curr_record.start();
```