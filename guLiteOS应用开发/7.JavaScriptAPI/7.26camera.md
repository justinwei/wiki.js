### 一、模块介绍

Camera 模块用于封装相机功能，提供初始化、设置属性、启动相机、获取照片以及获取视频日志等功能。

### 二、API

#### 1、createCamera(options)

创建一个 Camera 实例。
- `options`：初始化相机时的配置选项。
  - `node`：摄像头节点，用于指定相机的硬件设备。

#### 2、camera.set(options)

设置相机属性。该接口目前仅支持默认参数
- `options`：相机属性配置选项。
  - `mode`: 相机的模式（1：拍照-默认，2：录像， 3：二维码识别）
  - `width`：相机宽度。
  - `height`：相机高度。
  - `aspectRatio`：相机长宽比。
    - 1:1 === 0
    - 3:4 === 1
    - 16:9 === 2
    - full === 3
  - `cameraType`：相机类型（前置："front"或后置:"rear"摄像头）, 目前仅支持后置摄像头。

返回值：成功返回0，失败返回-1。

#### 3、camera.start(obj)

启动相机。
- obj: pointer，创建预览窗口的容器

返回值：成功返回0，失败返回-1。

#### 4、camera.getPicture(options)

拍照
- `options`：获取照片的配置选项。
  - `saveParam`：对象数组，保存照片的路径（包含相片命名），分辨率等参数。
    - `path`: 路径
    - `w`: 宽（分辨率）
    - `h`: 高（分辨率)
    - `format`：照片格式。目前支持"jpg","bin"

返回值：成功返回0，失败返回-1。

#### 5、camera.getVlog(options, callback)

视频录制。该接口为预留接口，暂未支持
- `options`：获取视频日志的配置选项。
  - `savePath`：保存视频的路径（包含视频文件命名）。
  - `format`：照片格式。目前仅支持原始数据yuv
- `callback(err)`: 视频录制回调

返回值：成功返回包含以下方法的对象，失败返回null。
- `stop()`：停止录制视频。
- `pause()`：暂停录制视频。
- `resume()`：恢复录制视频。

#### 6、camera.scanIdentification(options, callback)

摄像头扫描：例如二维码识别，条形码，花草识别等等，目前仅支持二维码识别；
- `options`：
    - `x`: 屏幕上面有效的扫描区域的起始横坐标
    - `y`: 屏幕上面有效的扫描区域的起始纵坐标
    - `w`: 屏幕上面有效的扫描区域的宽
    - `h`: 屏幕上面有效的扫描区域的高
- `callback(options)`: 结果产生的回调
    - `options.errcode`: 0表示获取到二维码，如果payload为“QR code recognition error”表示识别错误，1表示扫描到了二维码
    - `options.payload`: payload array buffer
    - `total`: 一次识别有多少个二维码

#### 7、camera.destroy()

销毁相机实例。

### 三、例子

```

var camera = require('camera');

const cameraNode = '/dev/video0';

var myCamera = camera.createCamera({node: cameraNode});

//该接口为模拟接口
var obj = get_lvgl_obj();

if (myCamera) {
    // 设置相机属性
    myCamera.set({ width: 320, height: 480, aspectRatio: 3, cameraType: 'rear'});

    // 启动相机
    myCamera.start(obj);

    // 获取照片
    myCamera.getPicture({ saveParam: [{path: './1.jpg', w: 320, h: 48, format: 'jpg'}, {path: './1_1.jpg', w: 100, h: 100, format: 'jpg'}] });

    // 获取视频日志
    var vlog = myCamera.getVlog({ savePath: './1.yuv', format: 'yuv' });

    //8秒后暂停，暂停后过1s恢复录制，恢复后过3秒停止录制
    setTimeout(function() {
        vlog.pause();
        setTimeout(function() {
            vlog.resume();
            setTimeout(function() {
                vlog.stop();
            }, 3000);
        }, 1000);
    }, 8000);
} else {
  console.error('Camera initialization failed.');
}
```

```
var myCamera = camera.createCamera(a);

//该接口为模拟接口
var obj = {};

var resume_ca = function() {
	myCamera.resume();
	myCamera.set({cameraMode: 3});
	myCamera.scanIdentification({x: 76, y: 44, w: 200, h: 200}, function(options) {
		console.log('errcode:', options.errcode, 'payload array:', options.payload);
		if (options.errcode == 0) {
			myCamera.pause();
			setTimeout(resume_ca, 5000);
		}
	})
}

if (myCamera) {
    // 设置相机属性
    // myCamera.set({ width: 320, height: 480, aspectRatio: 3, cameraType: 'rear'});
	myCamera.set({cameraMode: 3});
    // 启动相机
    myCamera.start(obj);
	setTimeout(resume_ca, 100);
} else {
  console.error('Camera initialization failed.');
}
```