webpackHotUpdate("theme0",{

/***/ "./node_modules/cache-loader/dist/cjs.js?!./node_modules/babel-loader/lib/index.js?!./node_modules/vue-loader/lib/index.js?!./client/themes/default/components/nav-sidebar.vue?vue&type=script&lang=js&":
/*!*********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/cache-loader/dist/cjs.js??ref--0-0!./node_modules/babel-loader/lib??ref--0-1!./node_modules/vue-loader/lib??vue-loader-options!./client/themes/default/components/nav-sidebar.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************************************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash/get */ \"./node_modules/lodash/get.js\");\n/* harmony import */ var lodash_get__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var lodash_union__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash/union */ \"./node_modules/lodash/union.js\");\n/* harmony import */ var lodash_union__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash_union__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var lodash_take__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash/take */ \"./node_modules/lodash/take.js\");\n/* harmony import */ var lodash_take__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash_take__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var lodash_findIndex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash/findIndex */ \"./node_modules/lodash/findIndex.js\");\n/* harmony import */ var lodash_findIndex__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash_findIndex__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var lodash_intersection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash/intersection */ \"./node_modules/lodash/intersection.js\");\n/* harmony import */ var lodash_intersection__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash_intersection__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var vuedraggable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! vuedraggable */ \"./node_modules/vuedraggable/dist/vuedraggable.umd.min.js\");\n/* harmony import */ var vuedraggable__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(vuedraggable__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var vuex_pathify__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! vuex-pathify */ \"./node_modules/vuex-pathify/dist/vuex-pathify.js\");\n/* harmony import */ var vuex_pathify__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(vuex_pathify__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n/* global siteLangs, siteConfig */\n\nconst reorderTreeMutation = {\n  \"kind\": \"Document\",\n  \"definitions\": [{\n    \"kind\": \"OperationDefinition\",\n    \"operation\": \"mutation\",\n    \"variableDefinitions\": [{\n      \"kind\": \"VariableDefinition\",\n      \"variable\": {\n        \"kind\": \"Variable\",\n        \"name\": {\n          \"kind\": \"Name\",\n          \"value\": \"parent\"\n        }\n      },\n      \"type\": {\n        \"kind\": \"NamedType\",\n        \"name\": {\n          \"kind\": \"Name\",\n          \"value\": \"Int\"\n        }\n      },\n      \"directives\": []\n    }, {\n      \"kind\": \"VariableDefinition\",\n      \"variable\": {\n        \"kind\": \"Variable\",\n        \"name\": {\n          \"kind\": \"Name\",\n          \"value\": \"order\"\n        }\n      },\n      \"type\": {\n        \"kind\": \"NonNullType\",\n        \"type\": {\n          \"kind\": \"ListType\",\n          \"type\": {\n            \"kind\": \"NonNullType\",\n            \"type\": {\n              \"kind\": \"NamedType\",\n              \"name\": {\n                \"kind\": \"Name\",\n                \"value\": \"Int\"\n              }\n            }\n          }\n        }\n      },\n      \"directives\": []\n    }, {\n      \"kind\": \"VariableDefinition\",\n      \"variable\": {\n        \"kind\": \"Variable\",\n        \"name\": {\n          \"kind\": \"Name\",\n          \"value\": \"locale\"\n        }\n      },\n      \"type\": {\n        \"kind\": \"NonNullType\",\n        \"type\": {\n          \"kind\": \"NamedType\",\n          \"name\": {\n            \"kind\": \"Name\",\n            \"value\": \"String\"\n          }\n        }\n      },\n      \"directives\": []\n    }],\n    \"directives\": [],\n    \"selectionSet\": {\n      \"kind\": \"SelectionSet\",\n      \"selections\": [{\n        \"kind\": \"Field\",\n        \"name\": {\n          \"kind\": \"Name\",\n          \"value\": \"pages\"\n        },\n        \"arguments\": [],\n        \"directives\": [],\n        \"selectionSet\": {\n          \"kind\": \"SelectionSet\",\n          \"selections\": [{\n            \"kind\": \"Field\",\n            \"name\": {\n              \"kind\": \"Name\",\n              \"value\": \"reorderTree\"\n            },\n            \"arguments\": [{\n              \"kind\": \"Argument\",\n              \"name\": {\n                \"kind\": \"Name\",\n                \"value\": \"parent\"\n              },\n              \"value\": {\n                \"kind\": \"Variable\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"parent\"\n                }\n              }\n            }, {\n              \"kind\": \"Argument\",\n              \"name\": {\n                \"kind\": \"Name\",\n                \"value\": \"order\"\n              },\n              \"value\": {\n                \"kind\": \"Variable\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"order\"\n                }\n              }\n            }, {\n              \"kind\": \"Argument\",\n              \"name\": {\n                \"kind\": \"Name\",\n                \"value\": \"locale\"\n              },\n              \"value\": {\n                \"kind\": \"Variable\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"locale\"\n                }\n              }\n            }],\n            \"directives\": [],\n            \"selectionSet\": {\n              \"kind\": \"SelectionSet\",\n              \"selections\": [{\n                \"kind\": \"Field\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"responseResult\"\n                },\n                \"arguments\": [],\n                \"directives\": [],\n                \"selectionSet\": {\n                  \"kind\": \"SelectionSet\",\n                  \"selections\": [{\n                    \"kind\": \"Field\",\n                    \"name\": {\n                      \"kind\": \"Name\",\n                      \"value\": \"succeeded\"\n                    },\n                    \"arguments\": [],\n                    \"directives\": []\n                  }, {\n                    \"kind\": \"Field\",\n                    \"name\": {\n                      \"kind\": \"Name\",\n                      \"value\": \"message\"\n                    },\n                    \"arguments\": [],\n                    \"directives\": []\n                  }]\n                }\n              }]\n            }\n          }]\n        }\n      }]\n    }\n  }],\n  \"loc\": {\n    \"start\": 0,\n    \"end\": 236,\n    \"source\": {\n      \"body\": \"\\n  mutation ($parent: Int, $order: [Int!]!, $locale: String!) {\\n    pages {\\n      reorderTree(parent: $parent, order: $order, locale: $locale) {\\n        responseResult {\\n          succeeded\\n          message\\n        }\\n      }\\n    }\\n  }\\n\",\n      \"name\": \"GraphQL request\",\n      \"locationOffset\": {\n        \"line\": 1,\n        \"column\": 1\n      }\n    }\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  components: {\n    draggable: (vuedraggable__WEBPACK_IMPORTED_MODULE_5___default())\n  },\n  props: {\n    color: {\n      type: String,\n      default: 'primary'\n    },\n    dark: {\n      type: Boolean,\n      default: true\n    },\n    items: {\n      type: Array,\n      default: () => []\n    },\n    navMode: {\n      type: String,\n      default: 'MIXED'\n    }\n  },\n  data() {\n    return {\n      currentMode: 'custom',\n      currentItems: [],\n      currentParent: {\n        id: 0,\n        title: '/ (root)',\n        locale: null\n      },\n      parents: [],\n      loadedCache: [],\n      isSorting: false,\n      sortLoading: false\n    };\n  },\n  computed: {\n    path: Object(vuex_pathify__WEBPACK_IMPORTED_MODULE_6__[\"get\"])('page/path'),\n    locale: Object(vuex_pathify__WEBPACK_IMPORTED_MODULE_6__[\"get\"])('page/locale'),\n    permissions: Object(vuex_pathify__WEBPACK_IMPORTED_MODULE_6__[\"get\"])('user/permissions'),\n    activeLocale() {\n      if (this.locale) {\n        return this.locale;\n      }\n      if (Array.isArray(siteLangs) && siteLangs.length > 0) {\n        const first = siteLangs[0];\n        if (first) {\n          if (typeof first === 'string') {\n            return first;\n          } else if (typeof first === 'object' && first.code) {\n            return first.code;\n          }\n        }\n      }\n      if (typeof siteConfig !== 'undefined' && siteConfig && siteConfig.lang) {\n        return siteConfig.lang;\n      }\n      return 'en';\n    },\n    canReorder() {\n      return lodash_intersection__WEBPACK_IMPORTED_MODULE_4___default()(this.permissions || [], ['manage:system', 'manage:pages', 'write:pages']).length > 0;\n    },\n    showSortControls() {\n      return this.canReorder && this.currentMode === 'browse';\n    },\n    sortButtonLabel() {\n      return this.isSorting ? this.$t('common:sidebar.finishSorting') : this.$t('common:sidebar.reorder');\n    }\n  },\n  watch: {\n    locale(newLocale, oldLocale) {\n      if (!newLocale || newLocale === oldLocale) {\n        return;\n      }\n      if (this.currentMode !== 'browse') {\n        return;\n      }\n      this.currentParent.locale = newLocale;\n      this.loadedCache = [];\n      this.fetchBrowseItems(this.currentParent);\n    }\n  },\n  methods: {\n    switchMode(mode) {\n      const prevMode = this.currentMode;\n      this.isSorting = false;\n      this.currentMode = mode;\n      window.localStorage.setItem('navPref', mode);\n      if (mode === `browse`) {\n        if (prevMode !== 'browse') {\n          this.parents = [this.currentParent];\n        }\n        this.loadedCache = [];\n        this.fetchBrowseItems(this.currentParent);\n      }\n    },\n    async fetchBrowseItems(item) {\n      this.isSorting = false;\n      this.$store.commit(`loadingStart`, 'browse-load');\n      if (!item) {\n        item = this.currentParent;\n      }\n      if (this.loadedCache.indexOf(item.id) < 0) {\n        this.currentItems = [];\n      }\n      if (item.id === 0) {\n        this.parents = [];\n      } else {\n        const flushRightIndex = lodash_findIndex__WEBPACK_IMPORTED_MODULE_3___default()(this.parents, ['id', item.id]);\n        if (flushRightIndex >= 0) {\n          this.parents = lodash_take__WEBPACK_IMPORTED_MODULE_2___default()(this.parents, flushRightIndex);\n        }\n        if (this.parents.length < 1) {\n          this.parents.push(this.currentParent);\n        }\n        this.parents.push(item);\n      }\n      this.currentParent = item;\n      const resp = await this.$apollo.query({\n        query: {\n          \"kind\": \"Document\",\n          \"definitions\": [{\n            \"kind\": \"OperationDefinition\",\n            \"operation\": \"query\",\n            \"variableDefinitions\": [{\n              \"kind\": \"VariableDefinition\",\n              \"variable\": {\n                \"kind\": \"Variable\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"parent\"\n                }\n              },\n              \"type\": {\n                \"kind\": \"NamedType\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"Int\"\n                }\n              },\n              \"directives\": []\n            }, {\n              \"kind\": \"VariableDefinition\",\n              \"variable\": {\n                \"kind\": \"Variable\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"locale\"\n                }\n              },\n              \"type\": {\n                \"kind\": \"NonNullType\",\n                \"type\": {\n                  \"kind\": \"NamedType\",\n                  \"name\": {\n                    \"kind\": \"Name\",\n                    \"value\": \"String\"\n                  }\n                }\n              },\n              \"directives\": []\n            }],\n            \"directives\": [],\n            \"selectionSet\": {\n              \"kind\": \"SelectionSet\",\n              \"selections\": [{\n                \"kind\": \"Field\",\n                \"name\": {\n                  \"kind\": \"Name\",\n                  \"value\": \"pages\"\n                },\n                \"arguments\": [],\n                \"directives\": [],\n                \"selectionSet\": {\n                  \"kind\": \"SelectionSet\",\n                  \"selections\": [{\n                    \"kind\": \"Field\",\n                    \"name\": {\n                      \"kind\": \"Name\",\n                      \"value\": \"tree\"\n                    },\n                    \"arguments\": [{\n                      \"kind\": \"Argument\",\n                      \"name\": {\n                        \"kind\": \"Name\",\n                        \"value\": \"parent\"\n                      },\n                      \"value\": {\n                        \"kind\": \"Variable\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"parent\"\n                        }\n                      }\n                    }, {\n                      \"kind\": \"Argument\",\n                      \"name\": {\n                        \"kind\": \"Name\",\n                        \"value\": \"mode\"\n                      },\n                      \"value\": {\n                        \"kind\": \"EnumValue\",\n                        \"value\": \"ALL\"\n                      }\n                    }, {\n                      \"kind\": \"Argument\",\n                      \"name\": {\n                        \"kind\": \"Name\",\n                        \"value\": \"locale\"\n                      },\n                      \"value\": {\n                        \"kind\": \"Variable\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"locale\"\n                        }\n                      }\n                    }],\n                    \"directives\": [],\n                    \"selectionSet\": {\n                      \"kind\": \"SelectionSet\",\n                      \"selections\": [{\n                        \"kind\": \"Field\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"id\"\n                        },\n                        \"arguments\": [],\n                        \"directives\": []\n                      }, {\n                        \"kind\": \"Field\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"path\"\n                        },\n                        \"arguments\": [],\n                        \"directives\": []\n                      }, {\n                        \"kind\": \"Field\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"title\"\n                        },\n                        \"arguments\": [],\n                        \"directives\": []\n                      }, {\n                        \"kind\": \"Field\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"isFolder\"\n                        },\n                        \"arguments\": [],\n                        \"directives\": []\n                      }, {\n                        \"kind\": \"Field\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"pageId\"\n                        },\n                        \"arguments\": [],\n                        \"directives\": []\n                      }, {\n                        \"kind\": \"Field\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"parent\"\n                        },\n                        \"arguments\": [],\n                        \"directives\": []\n                      }, {\n                        \"kind\": \"Field\",\n                        \"name\": {\n                          \"kind\": \"Name\",\n                          \"value\": \"locale\"\n                        },\n                        \"arguments\": [],\n                        \"directives\": []\n                      }]\n                    }\n                  }]\n                }\n              }]\n            }\n          }],\n          \"loc\": {\n            \"start\": 0,\n            \"end\": 344,\n            \"source\": {\n              \"body\": \"\\n          query ($parent: Int, $locale: String!) {\\n            pages {\\n              tree(parent: $parent, mode: ALL, locale: $locale) {\\n                id\\n                path\\n                title\\n                isFolder\\n                pageId\\n                parent\\n                locale\\n              }\\n            }\\n          }\\n        \",\n              \"name\": \"GraphQL request\",\n              \"locationOffset\": {\n                \"line\": 1,\n                \"column\": 1\n              }\n            }\n          }\n        },\n        fetchPolicy: 'cache-first',\n        variables: {\n          parent: item.id,\n          locale: this.activeLocale\n        }\n      });\n      this.loadedCache = lodash_union__WEBPACK_IMPORTED_MODULE_1___default()(this.loadedCache, [item.id]);\n      this.currentItems = lodash_get__WEBPACK_IMPORTED_MODULE_0___default()(resp, 'data.pages.tree', []);\n      this.$store.commit(`loadingStop`, 'browse-load');\n    },\n    toggleSortMode() {\n      if (!this.showSortControls || this.sortLoading) {\n        return;\n      }\n      this.isSorting = !this.isSorting;\n    },\n    async onSortEnd(evt) {\n      if (!this.isSorting || this.sortLoading) {\n        return;\n      }\n      if (!evt || evt.oldIndex === evt.newIndex) {\n        return;\n      }\n      await this.persistOrder();\n    },\n    async persistOrder() {\n      if (this.currentItems.length < 1) {\n        return;\n      }\n      this.sortLoading = true;\n      try {\n        const order = this.currentItems.map(item => item.id);\n        const parentId = this.currentParent && this.currentParent.id > 0 ? this.currentParent.id : null;\n        const resp = await this.$apollo.mutate({\n          mutation: reorderTreeMutation,\n          variables: {\n            parent: parentId,\n            order,\n            locale: this.activeLocale\n          }\n        });\n        const result = lodash_get__WEBPACK_IMPORTED_MODULE_0___default()(resp, 'data.pages.reorderTree.responseResult', {});\n        if (!result || !result.succeeded) {\n          throw new Error(result.message || 'Unable to update order.');\n        }\n        this.$store.commit('showNotification', {\n          message: result.message || 'Directory order updated.',\n          style: 'success',\n          icon: 'check'\n        });\n        this.isSorting = false;\n      } catch (err) {\n        console.error(err);\n        this.$store.commit('showNotification', {\n          message: err.message || 'Unable to update order.',\n          style: 'red',\n          icon: 'alert'\n        });\n        await this.fetchBrowseItems();\n      } finally {\n        this.sortLoading = false;\n      }\n    },\n    onFolderClick(item) {\n      if (this.isSorting || this.sortLoading) {\n        return;\n      }\n      this.fetchBrowseItems(item);\n    },\n    onPageClick(event) {\n      if (this.isSorting || this.sortLoading) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    },\n    goHome() {\n      window.location.assign(siteLangs.length > 0 ? `/${this.activeLocale}/home` : '/');\n    }\n  },\n  mounted() {\n    this.currentParent.title = `/ ${this.$t('common:sidebar.root')}`;\n    this.currentParent.locale = this.locale || this.activeLocale;\n    this.parents = [this.currentParent];\n    if (this.navMode === 'TREE') {\n      this.currentMode = 'browse';\n    } else if (this.navMode === 'STATIC') {\n      this.currentMode = 'custom';\n    } else {\n      this.currentMode = window.localStorage.getItem('navPref') || 'custom';\n    }\n    if (this.currentMode === 'browse') {\n      if (this.locale) {\n        this.fetchBrowseItems(this.currentParent);\n      }\n    }\n  }\n});\n\n//# sourceURL=webpack:///./client/themes/default/components/nav-sidebar.vue?./node_modules/cache-loader/dist/cjs.js??ref--0-0!./node_modules/babel-loader/lib??ref--0-1!./node_modules/vue-loader/lib??vue-loader-options");

/***/ })

})